<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compiling and linking with c-files on MaxOS &mdash; Transient Grounwater Course IHE Delft 2024.0rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8bbba70f"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Transient Grounwater Course IHE Delft
          </a>
              <div class="version">
                2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html">1. Nomenclature</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#introduction">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#introduction-to-transient-phenomena-in-groundwater">3. Introduction to transient phenomena in groundwater</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#irreversible-transient-phenomena">4. Irreversible transient phenomena</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#reversible-groundwater-storage">5. Reversible groundwater storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#one-dimensional-transient-groundwater-flow">6. One-dimensional transient groundwater flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#transient-flow-to-wells">7. Transient flow to wells</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#convolution">8. Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#laplace-solutions-illustration-not-for-exam">9. Laplace solutions (illustration, not for exam)</a></li>
<li class="toctree-l1"><a class="reference internal" href="TransientGroundwater.html#bibliography">10. Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Old exams:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="exams_from_2006.html">Previous exams</a></li>
<li class="toctree-l1"><a class="reference internal" href="exams_from_2006%2Banswers.html">Previous exams with answers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Transient Grounwater Course IHE Delft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Compiling and linking with c-files on MaxOS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="compiling-and-linking-with-c-files-on-maxos">
<h1>Compiling and linking with c-files on MaxOS<a class="headerlink" href="#compiling-and-linking-with-c-files-on-maxos" title="Link to this heading"></a></h1>
<section id="problems">
<h2>Problems:<a class="headerlink" href="#problems" title="Link to this heading"></a></h2>
<p>Compilation and linking troubles on MaxOS, because Apple changed oridnary locations for include files and change the way the dynamic libarries are to be linked:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* no stdlib.h and stdio.h in /usr/include
* no direct access to dynamic libraries; you must now use the `dynamic library cache`.
</pre></div>
</div>
<p>Therefore Pymake is no longer up-to-date and we have to alter the makefile that our programs by hand to get the compiling and linking done.</p>
</section>
<section id="compiling-the-incude-files">
<h2>Compiling, the incude files<a class="headerlink" href="#compiling-the-incude-files" title="Link to this heading"></a></h2>
<p>First make sure that the include files are found by softlinking them to the standard directory where they are normallly searched</p>
<p>The coarse method is (which I did) by typing in terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo ln -s /Library/Developer/CommandLineTools/SDKs/MacOSX11.1.sdk/usr/include/*.h /usr/local/include
</pre></div>
</div>
<p>However, this may be a better (more hygienic way) to achieve the same effect by typing in terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ export CPATH=/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/
</pre></div>
</div>
<p>Then show the new softlink by typling in terminal:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ls -sla /usr/local/include/stdio.h
</pre></div>
</div>
<p>to get</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0 lrwxr-xr-x  1 root  wheel  75 Nov  1  2021 /usr/local/include/stdio.h -&gt; /Library/Developer/CommandLineTools/SDKs/MacOSX11.1.sdk/usr/include/stdio.h
</pre></div>
</div>
<p>which shows the created softlink from <code class="docutils literal notranslate"><span class="pre">/usr/loca/bin</span></code> to the deeply burried <code class="docutils literal notranslate"><span class="pre">include</span></code> files</p>
</section>
<section id="linking-using-the-dynamic-link-cache">
<h2>Linking, using the dynamic link cache<a class="headerlink" href="#linking-using-the-dynamic-link-cache" title="Link to this heading"></a></h2>
<p>To use the dynamic link cache, we first have to find out where it is. A command-line session showing how to find it is here</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>https://developer.apple.com/forums/thread/669094
</pre></div>
</div>
<p>Following this session partly:</p>
<p>Make a small test c-program, here shown using <code class="docutils literal notranslate"><span class="pre">cat</span></code> in terminal</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat test.c
#include &lt;unistd.h&gt;
const unsigned char pmessagebuf[13] = &quot;hello world\n&quot;;
int main (int argc, char* argv[])
{
write(STDOUT_FILENO, (void*)pmessagebuf, 12);
return(0);
}
</pre></div>
</div>
<p>Compiling and linke can be done automatically</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cc test.c -o test
</pre></div>
</div>
<p>and then the program text can be run</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ ./test
hello world
</pre></div>
</div>
<p>TO see what’s happening behind the screens, add the -v (–verbose) option and recompile</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cc test.o -o test --verbose
</pre></div>
</div>
<p>This spits out a lot of information, among which the full line of the call to the linker (ld)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld&quot; -demangle -lto_library /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/libLTO.dylib -no_deduplicate -dynamic -arch x86_64 -platform_version macos 12.0.0 12.3 -syslibroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk -o test -L/usr/local/lib /var/folders/90/m51x_b713y561gzh2kzy18d00000gq/T/test-b03556.o -lSystem /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/clang/13.1.6/lib/darwin/libclang_rt.osx.a
</pre></div>
</div>
<p>In is line is the following option:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-syslibroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk
</pre></div>
</div>
<p>which is the system cache</p>
<p>So to make your own make file work, define a parameter to hold this sysroot like so</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk
</pre></div>
</div>
<p>and add <code class="docutils literal notranslate"><span class="pre">-syslibroot==$sysroot</span></code> to the line in hte make file that constructs your program (with the linker).</p>
<p>Note: in <code class="docutils literal notranslate"><span class="pre">gortran</span></code>, the option use <code class="docutils literal notranslate"><span class="pre">-sysroot=$sysroot</span></code> not <code class="docutils literal notranslate"><span class="pre">-syslibroot</span></code>.</p>
<p>In your makefile this may look like this (here I am compiling the program modflow 2005):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mf2005: $(OBJECTS)
    -$(F90) $(F90FLAGS) -o $(PROGRAM) --sysroot $(SYSLIBROOT) $(OBJECTS) $(SYSLIBS) -I$(OBJDIR) -J$(OBJDIR) 
</pre></div>
</div>
<p>and type</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ make all
</pre></div>
</div>
<p>in the terminal</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2024, TN Olsthoorn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>