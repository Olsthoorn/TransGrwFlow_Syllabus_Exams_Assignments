<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assignment Jan 2019. A building pit next to a river &mdash; Transient Grounwater Course IHE Delft 2024.0rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8bbba70f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Assignment Jan 2017 preventing extraction from river" href="AssJan2017.html" />
    <link rel="prev" title="Assigment Jan 2020" href="AssJan2020.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Transient Grounwater Course IHE Delft
          </a>
              <div class="version">
                2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html">1. Nomenclature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#introduction">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#introduction-to-transient-phenomena-in-groundwater">3. Introduction to transient phenomena in groundwater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#irreversible-transient-phenomena">4. Irreversible transient phenomena</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#reversible-groundwater-storage">5. Reversible groundwater storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#one-dimensional-transient-groundwater-flow">6. One-dimensional transient groundwater flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#transient-flow-to-wells">7. Transient flow to wells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#convolution">8. Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#laplace-solutions-illustration-not-for-exam">9. Laplace solutions (illustration, not for exam)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#bibliography">10. Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Old exams:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exams_from_2006.html">Previous exams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exams_from_2006%2Banswers.html">Previous exams with answers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Old Assignments:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../old_assignments.html">Previous Assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssWithAnswers.html">Assignment 2016 2022 with answers</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2022.html">Assignment Jan 2022. Wells along a river</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2021.html">Assignment Jan 2021. Wells along a river in a closed valley</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2020.html">Assigment Jan 2020</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Assignment Jan 2019. A building pit next to a river</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Problem-statement">Problem statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Questions">Questions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Hints">Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Modules-you-wil-need-are-imported-here">Modules you wil need are imported here</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convenient-plotting-functions">Convenient plotting functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Setup-the-situation,-define-the-wells-and-observation-point">Setup the situation, define the wells and observation point</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Fulfilling-the-required-drawdown">Fulfilling the required drawdown</a></li>
<li class="toctree-l3"><a class="reference internal" href="#River-stage-change">River-stage change</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Impact-of-the-month-long-wave-in-the-river-stage">Impact of the month-long wave in the river stage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Impact-of-river-tide">Impact of river tide</a></li>
<li class="toctree-l2"><a class="reference internal" href="#How-much-water-is-extracted-from-the-river?">How much water is extracted from the river?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2017.html">Assignment Jan 2017 preventing extraction from river</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2016.html">Assignment Jan 2016. Several exercises based on the syllabus</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Transient Grounwater Course IHE Delft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Assignment Jan 2019. A building pit next to a river</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/AssJan2019.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Assignment-Jan-2019.-A-building-pit-next-to-a-river">
<h1>Assignment Jan 2019. A building pit next to a river<a class="headerlink" href="#Assignment-Jan-2019.-A-building-pit-next-to-a-river" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>T.N.Olsthoorn, 2019-01-04, june 2022</p>
</dd>
</dl>
<section id="Problem-statement">
<h2>Problem statement<a class="headerlink" href="#Problem-statement" title="Link to this heading"></a></h2>
<img alt="Situations sketch" src="../_images/AssJan2019_1.png" />
<ol class="arabic simple">
<li><p>A large construction is to be realized next to a river that is in direct contact with the aquifer next to it. The building pit measures 50x50 m and river side is at 400 m distance from the river shore.</p></li>
<li><p>Transmissivity and storage coefficient are given: <span class="math notranslate nohighlight">\(kD=900\,\mathrm{m^{2}/d}\)</span>, <span class="math notranslate nohighlight">\(S^{=}0.25\)</span>.</p></li>
<li><p>The drawdown everywhere in the building pit must be at least 5 m, to be reached within one month of pumping.</p></li>
<li><p>The pumping will continue after this month for 5 more months during which the drawdown is to be maintained. However the pumping can be reuced after the first month. Adjust the pumping once per month, such that at the end of each month the darwdown fullfils the requied 5 m.</p></li>
<li><p>After 6 months, pumping is stopped, so that the water levels can restore.</p></li>
</ol>
</section>
<section id="Questions">
<h2>Questions<a class="headerlink" href="#Questions" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p>On which two corners of the builing pit should you place the two extraction wells to have most effect.</p></li>
<li><p>Find the most critical point and make sure that the drawdown is as required at that point.</p></li>
<li><p>Show the extraction as a function of time from the start until one year after the stop. Also plot the drawdown at the critical location for this period.</p></li>
<li><p>Compute as a function of time the flow from the river into the groundwater system. It is assumed that the groundwater head is initially uniform and equal to the river stage (water level in the river). Do this for the averate flow during the 6 month of building pit operation (ignore the variation in the extraction for simplicity).</p></li>
<li><p>How much time is required after stopping until about 90% of the drawdown has disappeared?</p></li>
<li><p>After exactly 3 months, the water level in the river rises suddenly by 1 m and stays so during one month, after which it suddenly returns to its original level.</p>
<p>To what extent does this wave affect the water level in the building pit if no measure is taken?</p>
<p>What must be the extraction during this month to guarantee that the building pit fulfills the required 5 m drawdown relative to the original water level? If both effects do not overlap, say so, and explain what you could to as building-pit owner to better counteract the effect of the wave in the river stage on the head below the building pit</p>
</li>
<li><p>If the river is influenced by sea tide, such that its level fluctuates twice a day between +1 and -1 m relative to the average value. How does this tide influence the required pumping? Is the location of the most critical point still the same?</p>
<p>How much is the delay between the tide in the river and the fluctuation at the critical point in the building pit?</p>
</li>
</ol>
</section>
<section id="Hints">
<h2>Hints<a class="headerlink" href="#Hints" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Work out the assigment in this Jupyter notebook. Take some time to become familiar with it. There is a tremendous amount of help on the internet to get you going. The site on <code class="docutils literal notranslate"><span class="pre">github.com/Olsthoorn/TransientGroundwaterFlow</span></code> hold numerous examples from the syllabus in the form of <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebooks</span></code>.</p></li>
<li><p>Also refer to the notebooks for the second year students of the TUDelft by Mark bakker (search for <code class="docutils literal notranslate"><span class="pre">Bakker</span> <span class="pre">exploratory</span></code> computing to find them).</p></li>
<li><p>You will gain some experience with the Notebooks (see their help)</p>
<ol class="loweralpha simple">
<li><p>with python</p></li>
<li><p>with numpy</p></li>
<li><p>with functions in scipy</p></li>
</ol>
</li>
<li><p>Make sure your assigment is a self-contained document, that you could also export as html or pdf for sharing to those who do not have python installed.</p></li>
</ol>
</section>
<section id="Modules-you-wil-need-are-imported-here">
<h2>Modules you wil need are imported here<a class="headerlink" href="#Modules-you-wil-need-are-imported-here" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">exp1</span> <span class="c1"># Theis well function</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfc</span>

<span class="c1"># import the necessary fucntionality</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">exp1</span> <span class="k">as</span> <span class="n">W</span> <span class="c1"># Theis well function</span>
<br/><br/></pre></div>
</div>
</div>
</section>
<section id="Convenient-plotting-functions">
<h2>Convenient plotting functions<a class="headerlink" href="#Convenient-plotting-functions" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newfig</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xx-small&#39;</span><span class="p">,</span> <span class="s1">&#39;x-small&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fontsize</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">,</span> \
        <span class="s2">&quot;fontsize not int and not in [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span>
             <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">newfigs</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">xlabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">ylabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">xscales</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscales</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xx-small&#39;</span><span class="p">,</span> <span class="s1">&#39;x-small&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fontsize</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">,</span> \
        <span class="s2">&quot;fontsize not int and not in [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">*</span><span class="n">layout</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;layout must be a 2-tuple (nrows, ncols) not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">layout</span><span class="p">))</span>
    <span class="n">n_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xscales</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">xscales</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_axes</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">yscales</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">yscales</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_axes</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">items_name</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;titles&#39;</span><span class="p">,</span> <span class="s1">&#39;xlabels&#39;</span><span class="p">,</span> <span class="s1">&#39;ylabels&#39;</span><span class="p">,</span> <span class="s1">&#39;xscales&#39;</span><span class="p">,</span> <span class="s1">&#39;yscales&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">titles</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">xscales</span><span class="p">,</span> <span class="n">yscales</span><span class="p">]):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">),</span> <span class="s1">&#39;len(</span><span class="si">{}</span><span class="s1">) == </span><span class="si">{}</span><span class="s1"> != len(layout) == </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">items_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">)))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">titles</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">xscales</span><span class="p">,</span> <span class="n">yscales</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span>
                 <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
            <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axs</span>
</pre></div>
</div>
</div>
</section>
<section id="Setup-the-situation,-define-the-wells-and-observation-point">
<h2>Setup the situation, define the wells and observation point<a class="headerlink" href="#Setup-the-situation,-define-the-wells-and-observation-point" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kD</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="mf">0.25</span> <span class="c1"># m2/d, (-)</span>

<span class="n">W</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">L</span> <span class="o">=</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mi">400</span>
<span class="c1"># The building pit</span>
<span class="n">pit</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ul&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">},</span>
       <span class="s1">&#39;ur&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">},</span>
       <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="o">-</span><span class="n">B</span><span class="p">},</span>
       <span class="s1">&#39;ll&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>  <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="o">-</span><span class="n">B</span><span class="p">},</span>
       <span class="s1">&#39;mid&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>  <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">},</span>
       <span class="s1">&#39;ctr&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">},</span>
       <span class="s1">&#39;crit&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="o">-</span><span class="n">B</span><span class="p">},</span>
<span class="p">}</span>

<span class="c1"># The . This is also the answer to Q1, the wells are at the two corners closest to the river.</span>
<span class="n">wells</span> <span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;wel&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">},</span>
        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;wel&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">},</span>
        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;mir&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">L</span><span class="p">},</span>
        <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;mir&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">L</span><span class="p">},</span>

<span class="p">}</span>

<span class="n">regime</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;2020-</span><span class="si">{</span><span class="n">mm</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">-01&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>  <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)])</span>

<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1325.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1200.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1150.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,])</span> <span class="o">*</span> <span class="mi">5</span> <span class="c1"># Initially guessed pumping regime.</span>
<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])))</span>

<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;stage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,]</span> <span class="c1"># river stage</span>
<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dstage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;stage&#39;</span><span class="p">])))</span> <span class="c1"># river change stage.</span>

<span class="n">tstart</span> <span class="o">=</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tsim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tstart</span><span class="p">,</span> <span class="n">tstart</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">366</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<section id="Fulfilling-the-required-drawdown">
<h3>Fulfilling the required drawdown<a class="headerlink" href="#Fulfilling-the-required-drawdown" title="Link to this heading"></a></h3>
<p>Q1: The two wells must be placed on the two corners of the building pit closest to the river. But because of the river, we also have to place two mirror wells on the opposite site with the opposite sign. These wells heve been defined in the dict ‘wells’ above.</p>
<p>Q2: The most critical point is the center of mid of the line of the building point that is farthest from the river.</p>
<p>Q3: After some trial and error, the regime[‘Q’] establishese the desired steady drawdown after one month of pumpiong.</p>
<p>Q4: The data at which the dradown is again less than 0.5 m is shown in the figure with the error and the thick dot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Water level at critical points&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;water level [m]&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">kp</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="s1">&#39;ctr&#39;</span><span class="p">,</span> <span class="s1">&#39;crit&#39;</span><span class="p">]:</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">pit</span><span class="p">[</span><span class="n">kp</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">pit</span><span class="p">[</span><span class="n">kp</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dQ</span><span class="p">,</span> <span class="n">change_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dQ&#39;</span><span class="p">],</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsim</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">-</span> <span class="n">change_date</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
            <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span>
            <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dQ</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp1</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;at point pit[</span><span class="si">{</span><span class="n">kp</span><span class="si">}</span><span class="s1">]=(</span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">y0</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2020-07-01&#39;</span><span class="p">),</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ts</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="n">tsim</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">criterion</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moment when drawdown becomes less than 0.5 m&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Drawdown becomes less than 0.5 m</span><span class="se">\n</span><span class="s1">at t=</span><span class="si">{</span><span class="n">ts</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">ss</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Extraction m3/d&#39;</span><span class="p">)</span>

<span class="n">nwells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;wel&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span> <span class="n">nwells</span> <span class="o">*</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Extraction&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8cdc962520&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2019_13_1.png" src="../_images/notebooks_AssJan2019_13_1.png" />
</div>
</div>
</section>
<section id="River-stage-change">
<h3>River-stage change<a class="headerlink" href="#River-stage-change" title="Link to this heading"></a></h3>
<p>Q6: What happens to the groundwater levels due to the change in the river stage?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dstages</span>       <span class="o">=</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dstage&#39;</span><span class="p">][</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dstage&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">change_dates</span>  <span class="o">=</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span> <span class="p">][</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dstage&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;Effect of the river stage on points in the building pit&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;delta h [m]&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="s1">&#39;ctr&#39;</span><span class="p">,</span> <span class="s1">&#39;crit&#39;</span><span class="p">]:</span>
    <span class="n">yp</span> <span class="o">=</span> <span class="n">pit</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">yp</span> <span class="c1"># distance from the river (river is at x=0 m)</span>
    <span class="k">for</span> <span class="n">dstage</span><span class="p">,</span> <span class="n">change_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dstages</span><span class="p">,</span> <span class="n">change_dates</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsim</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">-</span><span class="n">change_date</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>
        <span class="n">s</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dstage</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;point </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="n">yp</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8cdcd39a60&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2019_15_1.png" src="../_images/notebooks_AssJan2019_15_1.png" />
</div>
</div>
</section>
<section id="Impact-of-the-month-long-wave-in-the-river-stage">
<h3>Impact of the month-long wave in the river stage<a class="headerlink" href="#Impact-of-the-month-long-wave-in-the-river-stage" title="Link to this heading"></a></h3>
<p>Q6: Compensate for the effect of the change of the river stage.</p>
<p>We should superimpose this change on the drawdown by the wells and adapt the well regime to compensate for this stage change.</p>
<p>We should generate an extra drawdown of 0.4 m at the end of month 4. For this the regime has to be adapated</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1325.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1200.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1150.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1100.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,])</span> <span class="o">*</span> <span class="mi">5</span> <span class="c1"># Initially guessed pumping regime.</span>

<span class="c1"># Extraction that compensates for the river srage change</span>
<span class="c1"># Set both to 1 to see what happens without extra pumping.</span>
<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.10</span>
<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.05</span>

<span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">])))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Water level at critical points&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;water level [m]&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">kp</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="s1">&#39;ctr&#39;</span><span class="p">,</span> <span class="s1">&#39;crit&#39;</span><span class="p">]:</span>
    <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">pit</span><span class="p">[</span><span class="n">kp</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">pit</span><span class="p">[</span><span class="n">kp</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">-</span> <span class="n">yp</span> <span class="c1"># distance from the river (river is at x=0 m)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dQ</span><span class="p">,</span> <span class="n">change_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dQ&#39;</span><span class="p">],</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsim</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">-</span> <span class="n">change_date</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">kw</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
            <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span>
            <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">yp</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
            <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
            <span class="n">s</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dQ</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp1</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dstage</span><span class="p">,</span> <span class="n">change_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dstages</span><span class="p">,</span> <span class="n">change_dates</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsim</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">-</span><span class="n">change_date</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>
        <span class="n">s</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dstage</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;at point pit[</span><span class="si">{</span><span class="n">kp</span><span class="si">}</span><span class="s1">]=(</span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="n">y0</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>


<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Extraction m3/d&#39;</span><span class="p">)</span>

<span class="n">nwells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;wel&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span> <span class="n">nwells</span> <span class="o">*</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Extraction&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8cdcfd0550&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2019_18_1.png" src="../_images/notebooks_AssJan2019_18_1.png" />
</div>
</div>
</section>
</section>
<section id="Impact-of-river-tide">
<h2>Impact of river tide<a class="headerlink" href="#Impact-of-river-tide" title="Link to this heading"></a></h2>
<p>The impact is shown below. The penetration depth of the tide is so small compared to the distance between the river and the building pit, that no measures have to be taken.</p>
<p>Of course, in the case of a lower frequency tide, like two-monthly extra high tides, and storm tides, pentration depth will be larger and this compensation may become necessary.</p>
<p>The same is true for high river stages that persist over longer times than only one month and with much higher values. during wet periods.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="c1"># Amplitude (m), cycle time (d)</span>

<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">T</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kD</span><span class="p">))</span>

<span class="n">show_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="c1"># keep sign postiive use negative Y only in the graph</span>

<span class="n">ax</span> <span class="o">=</span><span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;Effect of river tide on the adjacent groundwater&quot;</span><span class="p">,</span> <span class="s2">&quot;distance from river[m]&quot;</span><span class="p">,</span> <span class="s2">&quot;efect of tide&quot;</span><span class="p">)</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">Y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">env</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">show_time</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">Y</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;tide at t=</span><span class="si">{</span><span class="n">show_time</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> h&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="o">+</span><span class="n">env</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;top envelope&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">env</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bottom env.&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8cdcd8c9a0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2019_20_1.png" src="../_images/notebooks_AssJan2019_20_1.png" />
</div>
</div>
</section>
<section id="How-much-water-is-extracted-from-the-river?">
<h2>How much water is extracted from the river?<a class="headerlink" href="#How-much-water-is-extracted-from-the-river?" title="Link to this heading"></a></h2>
<div class="math notranslate nohighlight">
\[Q_r  = Q e^{-u}\]</div>
<div class="math notranslate nohighlight">
\[q_r = \frac Q {2 \pi r} e^{-u}\]</div>
<div class="math notranslate nohighlight">
\[q_x = \frac Q {2 \pi} e^{-u} \frac{x - x_w}{r^2}\]</div>
<div class="math notranslate nohighlight">
\[q_y = \frac Q {2 \pi} e^{-u} \frac{y - y_w}{r^2}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">yp</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">L</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">Xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="o">-</span><span class="n">xx</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xx</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">Yr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Xr</span><span class="p">)</span>

<span class="n">qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Yr</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">tsim</span><span class="p">)))</span>
<span class="n">qx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">qy</span><span class="p">)</span>

<span class="k">for</span> <span class="n">dQ</span><span class="p">,</span> <span class="n">change_date</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dQ&#39;</span><span class="p">],</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">]):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">tsim</span><span class="p">[</span><span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">-</span> <span class="n">change_date</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
        <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">Xr</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Yr</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">S</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">qx</span><span class="p">[:,</span> <span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dQ</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx_</span> <span class="o">/</span> <span class="n">r2</span>
        <span class="n">qy</span><span class="p">[:,</span> <span class="n">tsim</span> <span class="o">&gt;</span> <span class="n">change_date</span><span class="p">]</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">dQ</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy_</span> <span class="o">/</span> <span class="n">r2</span>

<span class="n">Qx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">qx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">+</span>  <span class="n">qx</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Xr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">qy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">+</span>  <span class="n">qx</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Xr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;Extraction from the rive&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;Total extraction m3/d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">Qx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Qx m3/d (must be zero)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tsim</span><span class="p">,</span> <span class="n">Qy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Qy m3/d (= total induced from river)&#39;</span><span class="p">)</span>

<span class="n">nwells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;wel&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">regime</span><span class="p">[</span><span class="s1">&#39;dates&#39;</span><span class="p">],</span> <span class="n">nwells</span> <span class="o">*</span> <span class="n">regime</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">],</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Total extraction by wells&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8cdce21c70&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2019_22_1.png" src="../_images/notebooks_AssJan2019_22_1.png" />
</div>
</div>
<p>Q 7 The latter graph answers the last question.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AssJan2020.html" class="btn btn-neutral float-left" title="Assigment Jan 2020" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AssJan2017.html" class="btn btn-neutral float-right" title="Assignment Jan 2017 preventing extraction from river" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2024, TN Olsthoorn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>