<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assignment Jan 2022. Wells along a river &mdash; Transient Grounwater Course IHE Delft 2024.0rc1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=8bbba70f"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Assignment Jan 2021. Wells along a river in a closed valley" href="AssJan2021.html" />
    <link rel="prev" title="Assignment 2016 2022 with answers" href="AssWithAnswers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Transient Grounwater Course IHE Delft
          </a>
              <div class="version">
                2024
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html">1. Nomenclature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#introduction">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#introduction-to-transient-phenomena-in-groundwater">3. Introduction to transient phenomena in groundwater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#irreversible-transient-phenomena">4. Irreversible transient phenomena</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#reversible-groundwater-storage">5. Reversible groundwater storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#one-dimensional-transient-groundwater-flow">6. One-dimensional transient groundwater flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#transient-flow-to-wells">7. Transient flow to wells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#convolution">8. Convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#laplace-solutions-illustration-not-for-exam">9. Laplace solutions (illustration, not for exam)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TransientGroundwater.html#bibliography">10. Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Old exams:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exams_from_2006.html">Previous exams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exams_from_2006%2Banswers.html">Previous exams with answers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Old Assignments:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../old_assignments.html">Previous Assignments</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssWithAnswers.html">Assignment 2016 2022 with answers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Assignment Jan 2022. Wells along a river</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Problem-statement">Problem statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Convenient-plot-functions">Convenient plot functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-data">The data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.-Make-a-picture-of-the-water-table-at-a-line-through-the-pumping-well-perpendicular-to-the-river-at-t-the-following-times-0.001,-1day,-1-week,-1-month,-1-year,-10-years-after-the-start-of-the-extraction.">1. Make a picture of the water table at a line through the pumping well perpendicular to the river at t the following times 0.001, 1day, 1 week, 1 month, 1 year, 10 years after the start of the extraction.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#As-can-be-seen,-the-difference-between-the-situation-at-t=356-d-and-t=3650-d-is-very-small.-Hence,-we-can-assume-that-the-situation-at-t=3650-d-is-practically-steady-state.">As can be seen, the difference between the situation at t=356 d and t=3650 d is very small. Hence, we can assume that the situation at t=3650 d is practically steady-state.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Make-a-picture-of-the-head-contours-in-top-view-after-1-month,-1-year-and-10-years.">2. Make a picture of the head contours in top view after 1 month, 1 year and 10 years.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4-Inflow-from-the-river.">4 Inflow from the river.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Q8:-Find-the-point-where-the-inflow-is-just-zero.-(This-may-be-done-analytically)">Q8: Find the point where the inflow is just zero. (This may be done analytically)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Q9:-River-stage-varies-by-2-m-with-T-=-1-year-=-365-days">Q9: River stage varies by 2 m with T = 1 year = 365 days</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Q10:-plot-the-envelopes-around-the-actual-situation.-Just-use-steady-state-drawdown-for-convenience">Q10: plot the envelopes around the actual situation. Just use steady-state drawdown for convenience</a></li>
<li class="toctree-l3"><a class="reference internal" href="#11-the-delay-of-the-wave-at-the-point-where-the-amplitude-has-declined-by-a-factor-of-20">11 the delay of the wave at the point where the amplitude has declined by a factor of 20</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Q10:-By-how-much-will-the-water-table-rise-due-to-this-sudden-recharge-is-it-is-assumed-that-all-this-precipitation-will-add-to-the-groundwater?">Q10: By how much will the water table rise due to this sudden recharge is it is assumed that all this precipitation will add to the groundwater?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Q11:-Show-the-development-of-the-water-table-over-time-(for-a-few-times-after-the-shower-took-place)-by-adding-its-effect-to-the-steady-state-situation-(pumping-station-has-been-pumping-continuously-for-at-least-10-years?">Q11: Show the development of the water table over time (for a few times after the shower took place) by adding its effect to the steady-state situation (pumping station has been pumping continuously for at least 10 years?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2021.html">Assignment Jan 2021. Wells along a river in a closed valley</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2020.html">Assigment Jan 2020</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2019.html">Assignment Jan 2019. A building pit next to a river</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2017.html">Assignment Jan 2017 preventing extraction from river</a></li>
<li class="toctree-l1"><a class="reference internal" href="AssJan2016.html">Assignment Jan 2016. Several exercises based on the syllabus</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Transient Grounwater Course IHE Delft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Assignment Jan 2022. Wells along a river</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/AssJan2022.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Assignment-Jan-2022.-Wells-along-a-river">
<h1>Assignment Jan 2022. Wells along a river<a class="headerlink" href="#Assignment-Jan-2022.-Wells-along-a-river" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Prof. dr.ir. T.N.Olsthoorn</p>
</dd>
</dl>
<p>2021-12-22, june 2022</p>
<section id="Problem-statement">
<h2>Problem statement<a class="headerlink" href="#Problem-statement" title="Link to this heading"></a></h2>
<p>Consider a region to the right of a straight river which is in direct contact with a water table aquifer that has a transmissivity of 900 m2/d or an average saturated thickness of 30 m and a horizontal conductivity of k=30 m/d. The specific yield of the aquifer is 10%.</p>
<p>There is a regional groundwater flow directed towards that river at a rate of q = 1 m2/d.</p>
<p>A groundwater pumping station with one well is installed at 1500 m distance from the river which starts extracting at time t=0 at a rate of 1200 m3/d. For the analysis the aquifer thickness can be considered constant as given above.</p>
<ol class="arabic simple">
<li><p>Make a picture of the water table at a line through the pumping well perpendicular to the river at t the following times 0.001, 1day, 1 week, 1 month, 1 year, 10 years after the start of the extraction.</p></li>
<li><p>Make a picture of the head contours in top view after 1 month, 1 year and 10 years.</p></li>
<li><p>Make a picture of the flow direction in top view after 1 month, 1 year and 10years.</p></li>
<li><p>Make a picture of the rate of inflow [m2/d] from the river after 1 month, 1 year and 10 years.</p></li>
<li><p>At what 2 points at the river is the inflow after 1 year just zero?</p></li>
<li><p>The river stage varies like a sine with an amplitude of 2 m and a cycle time of 1 year. How far from the river can this fluctuation be felt if one takes 10 cm amplitude as a criterion?</p></li>
<li><p>Plot the envelopes on top of the steady state (or the head after years of constant pumping).</p></li>
<li><p>How much is the delay of the stage wave in the river at the point where the amplitude is still only 10 cm?</p></li>
<li><p>There is a sudden shower of rain equal to 240 mm, which raises the water table suddenly and uniformly.</p></li>
<li><p>By how much will the water table rise due to this sudden recharge is it is assumed that all this precipitation will add to the groundwater?</p></li>
<li><p>Show the development of the water table over time (for a few times after the shower took place) by adding its effect to the steady-state situation (pumping station has been pumping continuously for at least 10 years?</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">exp1</span><span class="p">,</span> <span class="n">erfc</span>
</pre></div>
</div>
</div>
</section>
<section id="Convenient-plot-functions">
<h2>Convenient plot functions<a class="headerlink" href="#Convenient-plot-functions" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">newfig</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xx-small&#39;</span><span class="p">,</span> <span class="s1">&#39;x-small&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fontsize</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">,</span> \
        <span class="s2">&quot;fontsize not int and not in [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span>
             <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
        <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">newfigs</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">titles</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">xlabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">ylabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">],</span> <span class="n">xscales</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">yscales</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;xx-small&#39;</span><span class="p">,</span> <span class="s1">&#39;x-small&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;x-large&#39;</span><span class="p">,</span> <span class="s1">&#39;xx-large&#39;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fontsize</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fontsize</span> <span class="ow">in</span> <span class="n">sizes</span><span class="p">,</span> \
        <span class="s2">&quot;fontsize not int and not in [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sizes</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">*</span><span class="n">layout</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;layout must be a 2-tuple (nrows, ncols) not </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">layout</span><span class="p">))</span>
    <span class="n">n_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">xscales</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">xscales</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_axes</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">yscales</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">yscales</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_axes</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">items_name</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;titles&#39;</span><span class="p">,</span> <span class="s1">&#39;xlabels&#39;</span><span class="p">,</span> <span class="s1">&#39;ylabels&#39;</span><span class="p">,</span> <span class="s1">&#39;xscales&#39;</span><span class="p">,</span> <span class="s1">&#39;yscales&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">titles</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">xscales</span><span class="p">,</span> <span class="n">yscales</span><span class="p">]):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">),</span> <span class="s1">&#39;len(</span><span class="si">{}</span><span class="s1">) == </span><span class="si">{}</span><span class="s1"> != len(layout) == </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">items_name</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">layout</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">titles</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">xscales</span><span class="p">,</span> <span class="n">yscales</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xlim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ylim</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="n">xscale</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">yscale</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">yscale</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">([</span><span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">+</span>
                 <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()):</span>
            <span class="n">item</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">axs</span>
</pre></div>
</div>
</div>
</section>
<section id="The-data">
<h2>The data<a class="headerlink" href="#The-data" title="Link to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aquifer</span>
<span class="n">k</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">Sy</span>  <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.1</span> <span class="c1"># m/d, m, (-)</span>
<span class="n">kD</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">D</span> <span class="c1"># m2/d</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># m, distance from well to river</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">1200</span> <span class="c1"># m3/d, extraction from well</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># m2/d, unifrom groundwater dicharge from right to left</span>

<span class="n">show_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-01-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-02-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2032-01-01&#39;</span><span class="p">]])</span>
<span class="n">tstart</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2021-12-31T23:50&#39;</span><span class="p">)</span>

<span class="n">wells</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">-</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;r0&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">},</span>
         <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;sign&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="o">+</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;r0&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">},</span>
         <span class="p">}</span>
<br/></pre></div>
</div>
</div>
<section id="1.-Make-a-picture-of-the-water-table-at-a-line-through-the-pumping-well-perpendicular-to-the-river-at-t-the-following-times-0.001,-1day,-1-week,-1-month,-1-year,-10-years-after-the-start-of-the-extraction.">
<h3>1. Make a picture of the water table at a line through the pumping well perpendicular to the river at t the following times 0.001, 1day, 1 week, 1 month, 1 year, 10 years after the start of the extraction.<a class="headerlink" href="#1.-Make-a-picture-of-the-water-table-at-a-line-through-the-pumping-well-perpendicular-to-the-river-at-t-the-following-times-0.001,-1day,-1-week,-1-month,-1-year,-10-years-after-the-start-of-the-extraction." title="Link to this heading"></a></h3>
<p>We will use the show_times defined above, to show how to work with dates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The head at differnt times along the x-axis (from left to right thorugh pumping station, x=0 at river)</span>
<span class="n">Np</span> <span class="o">=</span> <span class="mi">601</span>
<span class="n">Xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span> <span class="c1"># x coordinates</span>
<span class="n">Yline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Xline</span><span class="p">)</span>

<span class="c1"># The head due to the reginal flow, with h=0 at x=0</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">Xline</span> <span class="c1"># not the sign</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;The head (change) along the line thorugh the well and its mirror.&quot;</span><span class="p">,</span> <span class="s2">&quot;x [m]&quot;</span><span class="p">,</span> <span class="s2">&quot;head change [m]&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">show_time</span> <span class="o">-</span> <span class="n">tstart</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">h</span> <span class="c1"># np.zeros_line(Xline)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
        <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">Xline</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Yline</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">r2</span><span class="p">[</span><span class="n">r2</span> <span class="o">&lt;</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp1</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;time =</span><span class="si">{</span><span class="n">show_time</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2022_9_0.png" src="../_images/notebooks_AssJan2022_9_0.png" />
</div>
</div>
</section>
<section id="As-can-be-seen,-the-difference-between-the-situation-at-t=356-d-and-t=3650-d-is-very-small.-Hence,-we-can-assume-that-the-situation-at-t=3650-d-is-practically-steady-state.">
<h3>As can be seen, the difference between the situation at t=356 d and t=3650 d is very small. Hence, we can assume that the situation at t=3650 d is practically steady-state.<a class="headerlink" href="#As-can-be-seen,-the-difference-between-the-situation-at-t=356-d-and-t=3650-d-is-very-small.-Hence,-we-can-assume-that-the-situation-at-t=3650-d-is-practically-steady-state." title="Link to this heading"></a></h3>
<p>It is convenient and later on much more compact to set up plots more generally with a function.</p>
</section>
<section id="2.-Make-a-picture-of-the-head-contours-in-top-view-after-1-month,-1-year-and-10-years.">
<h3>2. Make a picture of the head contours in top view after 1 month, 1 year and 10 years.<a class="headerlink" href="#2.-Make-a-picture-of-the-head-contours-in-top-view-after-1-month,-1-year-and-10-years." title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># Generate the 2 grids of coordinates: (using np.meshgrid)</span>
<span class="n">Np</span> <span class="o">=</span> <span class="mi">101</span>
<span class="c1"># For contours</span>
<span class="n">Xcline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Ycline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># For quiver</span>
<span class="n">Xqline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span><span class="o">//</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Yqline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span><span class="o">//</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">Xc</span><span class="p">,</span> <span class="n">Yc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Xcline</span><span class="p">,</span> <span class="n">Ycline</span><span class="p">)</span>
<span class="n">Xq</span><span class="p">,</span> <span class="n">Yq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">Xqline</span><span class="p">,</span> <span class="n">Yqline</span><span class="p">)</span>

<span class="n">aday</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">titles</span>  <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Contours date = </span><span class="si">{</span><span class="n">show_time</span><span class="si">}</span><span class="s1">, t=</span><span class="si">{</span><span class="p">(</span><span class="n">show_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tstart</span><span class="p">)</span><span class="o">/</span><span class="n">aday</span><span class="si">:</span><span class="s1">4g</span><span class="si">}</span><span class="s1"> d&#39;</span> <span class="k">for</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]]</span>
<span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x [m]&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]]</span>
<span class="n">ylabels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;y [m]&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]]</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">newfigs</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">titles</span><span class="p">,</span> <span class="n">xlabels</span><span class="p">,</span> <span class="n">ylabels</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">show_times</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]):</span>

    <span class="n">qx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Xq</span><span class="p">)</span>
    <span class="n">qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Xq</span><span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">Xc</span> <span class="o">*</span> <span class="mf">.0</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">show_time</span> <span class="o">-</span> <span class="n">tstart</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
        <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

        <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">Xc</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Yc</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">r2</span><span class="p">[</span><span class="n">r2</span> <span class="o">&lt;</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]</span>

        <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">Sy</span>  <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp1</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

        <span class="n">dxq</span><span class="p">,</span> <span class="n">dyq</span> <span class="o">=</span> <span class="n">Xq</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Yq</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">rq2</span> <span class="o">=</span> <span class="n">dxq</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dyq</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">uq</span> <span class="o">=</span> <span class="n">rq2</span> <span class="o">*</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">qx</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">uq</span><span class="p">)</span> <span class="o">*</span> <span class="n">dxq</span> <span class="o">/</span> <span class="n">rq2</span>
        <span class="n">qy</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">uq</span><span class="p">)</span> <span class="o">*</span> <span class="n">dyq</span> <span class="o">/</span> <span class="n">rq2</span>

    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">Xc</span><span class="p">,</span> <span class="n">Yc</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">Xq</span><span class="p">,</span> <span class="n">Yq</span><span class="p">,</span> <span class="n">qx</span><span class="p">,</span> <span class="n">qy</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2022_13_0.png" src="../_images/notebooks_AssJan2022_13_0.png" />
</div>
</div>
</section>
<section id="4-Inflow-from-the-river.">
<h3>4 Inflow from the river.<a class="headerlink" href="#4-Inflow-from-the-river." title="Link to this heading"></a></h3>
<p>This is in fact the same as the question above. The main difference is that we only need the y-values at x=0. Therefore our coordinates will be those along the river, i.e. a long vector of zeros for the x and regular values for the y coordinate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inflow at the river, i.e. X=0</span>
<span class="n">q</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># m2/d</span>

<span class="c1"># Generate the 2 grids of coordinates: (using np.meshgrid)</span>
<span class="n">Np</span> <span class="o">=</span> <span class="mi">101</span>
<span class="c1"># For contours</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">Yriv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">a</span> <span class="o">*</span> <span class="n">L</span><span class="p">,</span> <span class="n">Np</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Xriv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Yriv</span><span class="p">)</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;River inflow date m2/d, with a fixed base flow q=</span><span class="si">{</span><span class="n">q</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> m2/d&#39;</span><span class="p">,</span> <span class="s1">&#39;$q_</span><span class="si">{in}</span><span class="s1">$ [m2/d]&#39;</span><span class="p">,</span> <span class="s1">&#39;y [m]&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="n">show_times</span><span class="p">:</span>

    <span class="n">qx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Yriv</span><span class="p">)</span> <span class="o">+</span> <span class="n">q</span>
    <span class="n">qy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Yriv</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">show_time</span> <span class="o">-</span> <span class="n">tstart</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
        <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

        <span class="n">dx_</span><span class="p">,</span> <span class="n">dy_</span> <span class="o">=</span> <span class="n">Xriv</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">Yriv</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">dx_</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dy_</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">*</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
        <span class="n">qx</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">dx_</span> <span class="o">/</span> <span class="n">r2</span>
        <span class="n">qy</span> <span class="o">+=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">dy_</span> <span class="o">/</span> <span class="n">r2</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qx</span><span class="p">,</span> <span class="n">Yriv</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;date=</span><span class="si">{</span><span class="n">show_time</span><span class="si">}</span><span class="s1">, t=</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">3g</span><span class="si">}</span><span class="s1"> d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2022_15_0.png" src="../_images/notebooks_AssJan2022_15_0.png" />
</div>
</div>
<p>The flow will be permanently outward, even in the steady state situation (t = 3650 d). This is due to the strong groundwater flow from the right to the left.</p>
</section>
<section id="Q8:-Find-the-point-where-the-inflow-is-just-zero.-(This-may-be-done-analytically)">
<h3>Q8: Find the point where the inflow is just zero. (This may be done analytically)<a class="headerlink" href="#Q8:-Find-the-point-where-the-inflow-is-just-zero.-(This-may-be-done-analytically)" title="Link to this heading"></a></h3>
<p>There is no point at which the river infiltrates. For this to happen either the base flow should be less, or the extraction should be must higher.</p>
</section>
<section id="Q9:-River-stage-varies-by-2-m-with-T-=-1-year-=-365-days">
<h3>Q9: River stage varies by 2 m with T = 1 year = 365 days<a class="headerlink" href="#Q9:-River-stage-varies-by-2-m-with-T-=-1-year-=-365-days" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Tcycle</span> <span class="o">=</span> <span class="mi">365</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Tcycle</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kD</span><span class="p">))</span>

<span class="c1"># The answer for the point at which the amplitude is reduced from 2 to 0.1 m follows from: $\frac{0.1}{2} = e^{-a x}$</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;omega = </span><span class="si">{:.4g}</span><span class="s2"> rad/d&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a     = </span><span class="si">{:.4g}</span><span class="s2"> /m&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;L     = </span><span class="si">{:.4g}</span><span class="s2"> m&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
omega = 0.01721 rad/d
a     = 0.0009779 /m
L     = 3063 m
</pre></div></div>
</div>
<p>print(“The delay is {:.3g} d.”.format(L * a / omega))</p>
</section>
<section id="Q10:-plot-the-envelopes-around-the-actual-situation.-Just-use-steady-state-drawdown-for-convenience">
<h3>Q10: plot the envelopes around the actual situation. Just use steady-state drawdown for convenience<a class="headerlink" href="#Q10:-plot-the-envelopes-around-the-actual-situation.-Just-use-steady-state-drawdown-for-convenience" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">kD</span><span class="p">,</span> <span class="n">Sy</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mf">2.0</span>

<span class="n">Xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">q</span> <span class="o">/</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">Xline</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
    <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xline</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">r</span><span class="p">[</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]</span>

    <span class="n">s</span> <span class="o">+=</span> <span class="o">-</span><span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xline</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;Head with envelopes due to flutuating river&quot;</span><span class="p">,</span> <span class="s2">&quot;x [m]&quot;</span><span class="p">,</span> <span class="s2">&quot;head [m]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;head average.&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s</span> <span class="o">+</span> <span class="n">env</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Top envelope&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s</span> <span class="o">-</span> <span class="n">env</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Bottom envelope&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8f7af5d6d0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2022_22_1.png" src="../_images/notebooks_AssJan2022_22_1.png" />
</div>
</div>
</section>
<section id="11-the-delay-of-the-wave-at-the-point-where-the-amplitude-has-declined-by-a-factor-of-20">
<h3>11 the delay of the wave at the point where the amplitude has declined by a factor of 20<a class="headerlink" href="#11-the-delay-of-the-wave-at-the-point-where-the-amplitude-has-declined-by-a-factor-of-20" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\omega t - ax = const \rightarrow  v_x = \frac{dx}{dt} = \omega /a \rightarrow t = L / v_x = L a / \omega\]</div>
</section>
<section id="Q10:-By-how-much-will-the-water-table-rise-due-to-this-sudden-recharge-is-it-is-assumed-that-all-this-precipitation-will-add-to-the-groundwater?">
<h3>Q10: By how much will the water table rise due to this sudden recharge is it is assumed that all this precipitation will add to the groundwater?<a class="headerlink" href="#Q10:-By-how-much-will-the-water-table-rise-due-to-this-sudden-recharge-is-it-is-assumed-that-all-this-precipitation-will-add-to-the-groundwater?" title="Link to this heading"></a></h3>
<p>A uniform sudden shower of rain or rather recharge would thoretically lead to a sudden uniform rise of the head by <span class="math notranslate nohighlight">\(A = P / S_y\)</span>. Of course, reality is more complex, due to the difference between rain and infiltration into the subsurface, evaporation and delay in the unsaturated zone. These factors are neglected for now to allow the transient groundwater analys to be made.</p>
</section>
<section id="Q11:-Show-the-development-of-the-water-table-over-time-(for-a-few-times-after-the-shower-took-place)-by-adding-its-effect-to-the-steady-state-situation-(pumping-station-has-been-pumping-continuously-for-at-least-10-years?">
<h3>Q11: Show the development of the water table over time (for a few times after the shower took place) by adding its effect to the steady-state situation (pumping station has been pumping continuously for at least 10 years?<a class="headerlink" href="#Q11:-Show-the-development-of-the-water-table-over-time-(for-a-few-times-after-the-shower-took-place)-by-adding-its-effect-to-the-steady-state-situation-(pumping-station-has-been-pumping-continuously-for-at-least-10-years?" title="Link to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>

<span class="n">kD</span><span class="p">,</span> <span class="n">Sy</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mf">2.0</span>

<span class="n">Xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">301</span><span class="p">)</span>

<span class="n">P</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># Sudden recharge [m]</span>
<span class="n">dHp</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="n">Sy</span> <span class="c1"># Sudden head change [m]</span>

<span class="n">Tcycle</span> <span class="o">=</span> <span class="mi">365</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Tcycle</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">kD</span><span class="p">))</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xline</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">newfig</span><span class="p">(</span><span class="s2">&quot;Development highest and lowest heads after sudden shower&quot;</span><span class="p">,</span> <span class="s2">&quot;x [m]&quot;</span><span class="p">,</span> <span class="s2">&quot;head [m]&quot;</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">q</span> <span class="o">/</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">Xline</span> <span class="c1"># [m]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="p">:</span>
    <span class="n">well</span> <span class="o">=</span> <span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xline</span> <span class="o">-</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
    <span class="n">r</span><span class="p">[</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">well</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">]</span>

    <span class="n">s</span> <span class="o">+=</span> <span class="o">-</span><span class="n">well</span><span class="p">[</span><span class="s1">&#39;sign&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">Q</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">kD</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">env</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">env</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;top envelope&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;bottom envelope&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">clr</span><span class="p">,</span> <span class="n">show_time</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">clrs</span><span class="p">,</span> <span class="n">show_times</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">show_time</span> <span class="o">-</span> <span class="n">tstart</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Xline</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Sy</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">kD</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span>
    <span class="n">s_top</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">dHp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">erfc</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">s_bot</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">dHp</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">erfc</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s_top</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">show_time</span><span class="si">}</span><span class="s1">, t=</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3g</span><span class="si">}</span><span class="s1"> d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xline</span><span class="p">,</span> <span class="n">s_bot</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">show_time</span><span class="si">}</span><span class="s1">, t=</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3g</span><span class="si">}</span><span class="s1"> d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f8f5eb34850&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_AssJan2022_25_1.png" src="../_images/notebooks_AssJan2022_25_1.png" />
</div>
</div>
<p>The curves show that the water levels sudden rise with a constant values relative to the dashed envelopes, which is where the head would vary due to a sine-like varying river level. Then the head gradually declines towards the dashed lines again. Further, the head at the river (x=0) nver changes due to recharge. It’s fixed by the river.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="AssWithAnswers.html" class="btn btn-neutral float-left" title="Assignment 2016 2022 with answers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AssJan2021.html" class="btn btn-neutral float-right" title="Assignment Jan 2021. Wells along a river in a closed valley" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2006-2024, TN Olsthoorn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>